<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="referrer" content="no-referrer" />
  <title>Yandex RTB</title>
  <style>
    html,body{margin:0;padding:0;background:transparent}
    #wrap{display:block;width:100%;max-width:100%;margin:0 auto}
  </style>
  <script src="https://yandex.ru/ads/system/context.js" async></script>
</head>
<body>
  <div id="wrap">
    <div id="ya_rt_container"></div>
  </div>

  <script>
    (function () {
      // Можно передать ?block=R-A-... и ?renderTo=id через URL, иначе дефолт
      var qs = new URLSearchParams(location.search);
      var BLOCK_ID = qs.get('block')   || 'R-A-14383531-11';
      var RENDER_TO = qs.get('renderTo') || 'ya_rt_container';

      // Очередь для инициализации
      window.yaContextCb = window.yaContextCb || [];
      window.yaContextCb.push(function () {
        try {
          Ya.Context.AdvManager.render({
            blockId: BLOCK_ID,
            renderTo: RENDER_TO,
            onRender: function () {
              // Сообщаем родителю высоту — чтобы iframe подстроился
              function postSize(){
                var h = Math.max(
                  document.documentElement.scrollHeight,
                  document.body.scrollHeight,
                  document.documentElement.offsetHeight,
                  document.body.offsetHeight
                );
                try { parent.postMessage({type:'ya-rtb-size', h:h}, '*'); } catch(e) {}
              }
              postSize();
              setTimeout(postSize, 300);
              setTimeout(postSize, 1200);
              setTimeout(postSize, 3000);
              try {
                var mo = new MutationObserver(postSize);
                mo.observe(document.body, {childList:true, subtree:true});
              } catch(e) {}
            }
          });
        } catch(e) {}
      });
    })();
  </script>
</body>
</html>
